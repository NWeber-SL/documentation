# .NET Based Environments

The ShiftLeft Microagent is run with an application that has been analyzed by ShiftLeft. The Microagent runs alongside the application in production (or other environments such as staging, test, UAT).

## Requirements

To run the ShiftLeft microagent, you must:
- be running on a Windows operating system that has at least .NET Framework Runtime 4.5 installed.
- Analyze the application beforehand using the [Shiftleft CLI]((../../using-sl-the-shiftleft-cli). 

## Performing Analysis

Before running the microagent, you must first perform code analysis of the target application. During code analysis, Shiftleft will generate a Code Property Graph (CPG) which describes the application in a unique way. That CPG is uploaded to the Shiftleft SaaS where a Security Profile is created for the application. This Security Profile allows ShiftLeft to generate instrumentation custom tailored to the specific version of the application.

Performing analysis can be performed either as a separate step, allowing installation in a build / Continuous Integration (CI) environment, or in the same command used for running the agent itself.

To perform analysis beforehand, see [Analyzing Applications in CI](../getting-started/analyzing-applications-in-ci.md). Note that in this case, you will need to carry the produced `shiftleft.json` file to your runtime environment and make it available to the ShiftLeft microagent. This allows the microagent to associate the application to be run with the analysis.

To perform analysis in at the command line, you should first verify that you have met the [Shiftleft Inspect requirements for .NET](../../shiftleft-requirements.md).  Then follow the instructions for analysis using the [Shiftleft CLI](../getting-started/analyzing-applications-in-ci.md). The system will then submit the application to the cloud for analysis and wait for it to finish.


## Running your application with the ShiftLeft Microagent

- Running the microagent with *Internet Information Services (IIS)*
  - you should first copy the `shiftleft.json` file (that was generated during analysis) into the `C:\shiftleftDotNetAgent\spr` directory). 
  - you can then start sending requests to your application in the usual manner (e.g., through a browser or a script). The microagent will be activated once your application receives its first request.
- Running the microagent with *IIS Express*
  - You start the application through Shiftleft's CLI as follows:
        >  "C:\Program Files\Shiftleft\sl.exe" run --csharp "C:\Program Files\IIS Express\iisexpress.exe" <full path to the project location>
